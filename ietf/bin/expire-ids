#!/usr/bin/env python

import datetime, os
import syslog

from ietf import settings
from django.core import management
management.setup_environ(settings)

syslog.openlog(os.path.basename(__file__), syslog.LOG_PID, syslog.LOG_LOCAL0)

from ietf.idrfc.expire import *

if not in_id_expire_freeze():
    for doc in get_expired_ids():
        send_expire_notice_for_id(doc)
        expire_id(doc)
        syslog.syslog("Expired %s (id=%s)%s" % (doc.file_tag(), doc.pk, " in the ID Tracker" if doc.latest_event(type="started_iesg_process") else ""))

clean_up_id_files()
